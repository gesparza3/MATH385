################################################################################
# Load libraries
################################################################################

library(caret)

################################################################################
# Read in data
################################################################################

bikes <- read.csv("https://roualdes.us/data/bike.csv")

################################################################################
# Defin Mean Squared Error
################################################################################

MSE <- function(y, yhat) {
  mean((y - yhat)^2)
}

################################################################################
# Create folds
################################################################################

folds <- createFolds(bikes$cnt)

################################################################################
# Create MSE vectors
################################################################################

mse_mean <- rep(NA, 10)
mse_anova <- rep(NA, 10)

################################################################################
# Calculate MSE using K-folds
################################################################################

for(fold in length(folds)) {
  training <- folds[c(1:fold - 1, fold + 1:length(folds)]
