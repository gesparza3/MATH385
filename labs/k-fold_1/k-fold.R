################################################################################
# Load libraries
################################################################################

library(caret)

################################################################################
# Read in data
################################################################################

bikes <- read.csv("https://roualdes.us/data/bike.csv")

################################################################################
# Defin Mean Squared Error
################################################################################

MSE <- function(y, yhat) {
  mean((y - yhat)^2)
}

################################################################################
# Simple Mean
################################################################################

mean.yhat <- mean(bikes$cnt)

################################################################################
# ANOVA
################################################################################

model <- lm(cnt ~ as.factor(season), data=bikes)
anova.yhat <- predict(model)

################################################################################
# MSE on models
################################################################################

MSE(bikes$cnt, mean.yhat)
# [1] 3747654

MSE(bikes$cnt, anova.yhat)
# [1] 2447250

################################################################################
# Are these MSEs reasonable quantifications of your modelâ€™s ability to predict
# future (not your current) data? Why or why not?
################################################################################

# Not necessarily, the MSE is only telling us how these models performed against
# data that we already knew about. We would need to perform more tests against 
# unknown points and compare those values.
